

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Monitor API &mdash; python-devicecloud 0.4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="python-devicecloud 0.4 documentation" href="index.html"/>
        <link rel="next" title="Direct Web Services API" href="ws.html"/>
        <link rel="prev" title="File System Service API" href="filesystem.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> python-devicecloud
          

          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="core.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="devicecore.html">DeviceCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="streams.html">Streams API</a></li>
<li class="toctree-l1"><a class="reference internal" href="filedata.html">FileData API</a></li>
<li class="toctree-l1"><a class="reference internal" href="sci.html">SCI (Server Command Interface) API</a></li>
<li class="toctree-l1"><a class="reference internal" href="filesystem.html">File System Service API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Monitor API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#monitor-overview">Monitor Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-devicecloud.monitor">SCI API Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ws.html">Direct Web Services API</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">python-devicecloud</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Monitor API</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/monitor.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="monitor-api">
<h1>Monitor API<a class="headerlink" href="#monitor-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="monitor-overview">
<h2>Monitor Overview<a class="headerlink" href="#monitor-overview" title="Permalink to this headline">¶</a></h2>
<p>Provide access to the device cloud monitor API which can be used to
subscribe to topics to receive notifications when data is received
on the device cloud.</p>
</div>
<div class="section" id="module-devicecloud.monitor">
<span id="sci-api-documentation"></span><h2>SCI API Documentation<a class="headerlink" href="#module-devicecloud.monitor" title="Permalink to this headline">¶</a></h2>
<dl class="data">
<dt id="devicecloud.monitor.MON_ID_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_ID_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_ID_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>System-generated identifier for the monitor.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_CST_ID_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_CST_ID_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_CST_ID_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Device Cloud customer identifier.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_TOPIC_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_TOPIC_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_TOPIC_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>One or more topics to monitor separated by comma.  See the device cloud
documentation for more details</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_FORMAT_TYPE_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_FORMAT_TYPE_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_FORMAT_TYPE_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Format for delivered event data: xml, json</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_TRANSPORT_TYPE_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_TRANSPORT_TYPE_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_TRANSPORT_TYPE_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Transport method used to deliver push notifications to the
client application: tcp, http</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_HTTP_TRANSPORT_URL_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_HTTP_TRANSPORT_URL_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_HTTP_TRANSPORT_URL_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>For HTTP transport type only. URL of the customer web server. For http URLs,
the default listening port is 80; for https URLs, the default listening
port is 443.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_HTTP_TRANSPORT_TOKEN_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_HTTP_TRANSPORT_TOKEN_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_HTTP_TRANSPORT_TOKEN_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>For HTTP transport type only. Credentials for basic authentication
in the following format: <code class="docutils literal"><span class="pre">username:password</span></code></p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_HTTP_TRANSPORT_METHOD_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_HTTP_TRANSPORT_METHOD_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_HTTP_TRANSPORT_METHOD_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>For HTTP transport type only. HTTP method to use for sending
data: PUT or POST. The default is PUT.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_HTTP_CONNECT_TIMEOUT_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_HTTP_CONNECT_TIMEOUT_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_HTTP_CONNECT_TIMEOUT_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>For HTTP transport type only. Time in milliseconds Device Cloud waits
when attempting to connect to the destination http server. A value of
0 means use the system default of 5000 (5 seconds). Most monitors do
not need to configure this setting.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_HTTP_RESPONSE_TIMEOUT_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_HTTP_RESPONSE_TIMEOUT_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_HTTP_RESPONSE_TIMEOUT_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>For HTTP transport type only. Time in milliseconds Device Cloud waits
for a response for pushed events from the http server. A value of 0 means
use the system default of 5000 (5 seconds). Most monitors do not need to
configure this setting.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_TCP_ACK_OPTION_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_TCP_ACK_OPTION_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_TCP_ACK_OPTION_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>For TCP transport type only. Indicates whether the client will explicitly
acknowledge TCP push events or allow Device Cloud to automatically acknowledge
events when sent. Options include: explicit or off. The default is off.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_BATCH_SIZE_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_BATCH_SIZE_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_BATCH_SIZE_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies an upper bound on how many messages are aggregated before sending
a batch. The default is 100.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_BATCH_DURATION_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_BATCH_DURATION_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_BATCH_DURATION_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies an upper bound on the number of seconds messages are aggregated
before sending. The default is 10.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_COMPRESSION_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_COMPRESSION_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_COMPRESSION_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyword that specifies the method used to compress messages. Options include:
zlib or none. The default is none. For zlib, the deflate algorithm is used to
compress the data; use inflate to decompress the data.</p>
<p>Note: For backwards compatibility, gzip is accepted as a valid keyword.
Compression has always been done using the deflate algorithm.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_AUTO_REPLAY_ON_CONNECT">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_AUTO_REPLAY_ON_CONNECT</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_AUTO_REPLAY_ON_CONNECT" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean value that specifies whether Device Cloud replays any missed
published events before any new published events are forwarded. True
indicates missed published events are replayed. False indicates missed
published events are not replayed. The default is false.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_DESCRIPTION_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_DESCRIPTION_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_DESCRIPTION_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional text field used to label or describe the monitor.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_LAST_CONNECT_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_LAST_CONNECT_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_LAST_CONNECT_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies last connection time to the client application.</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_LAST_SENT_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_LAST_SENT_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_LAST_SENT_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies the last message pushed to the client application</p>
</dd></dl>

<dl class="data">
<dt id="devicecloud.monitor.MON_STATUS_ATTR">
<code class="descclassname">devicecloud.monitor.</code><code class="descname">MON_STATUS_ATTR</code><em class="property"> = &lt;devicecloud.conditions.Attribute object&gt;</em><a class="headerlink" href="#devicecloud.monitor.MON_STATUS_ATTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies the current connection status to the client application:</p>
<ul>
<li><dl class="first docutils">
<dt>CONNECTING: For HTTP monitors only. Device Cloud is attempting</dt>
<dd><p class="first last">to connect to the configured HTTP server. Once connected, the state changes to ACTIVE.</p>
</dd>
</dl>
</li>
<li><p class="first">ACTIVE: Monitor is connected and publishing events.</p>
</li>
<li><p class="first">INACTIVE: Monitor is not connected and events are not published or recorded.</p>
</li>
<li><dl class="first docutils">
<dt>SUSPENDED: For monitors with monAutoReplayOnConnect = True.  Monitor has disconnected,</dt>
<dd><p class="first last">but publish events are recorded for later replay.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>DISABLED: For HTTP monitors only. If a monitor has not connected for 24 hours,</dt>
<dd><p class="first last">the state is set to DISABLED, and publish events are not recorded for replay.
A disabled monitor must be reconfigured via the Monitor web service.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="class">
<dt id="devicecloud.monitor.MonitorAPI">
<em class="property">class </em><code class="descclassname">devicecloud.monitor.</code><code class="descname">MonitorAPI</code><span class="sig-paren">(</span><em>conn</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.MonitorAPI" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide access to the device cloud Monitor API for receiving push notifications</p>
<p>The Monitor API in the device cloud allows for the creation and destruction of
multiple &#8220;monitors.&#8221;  Each monitor is registered against one or more &#8220;topics&#8221;
which describe the data in which it is interested.</p>
<p>There are, in turn, two main ways to receive data matching the topics for a
given monitor:</p>
<ol class="arabic simple">
<li>Stream: The device cloud supports a protocol over TCP (optionally with SSL) over which
the batches of events will be sent when they are received.</li>
<li>HTTP: When batches of events are received, a configured web
service endpoint will received a POST request with the new data.</li>
</ol>
<p>Currently, this library supports setting up both types of monitors, but there
is no special support provided for parsing HTTP postback requests.</p>
<p>More information on the format for topic strings can be found in the <a class="reference external" href="http://goo.gl/6UiOCG">device
cloud documentation for monitors</a>.</p>
<p>Here&#8217;s a quick example showing a typical pattern used for creating a push monitor
and associated listener that triggers a callback.  Deletion of existing monitors
matching the same topics is not necessary but sometimes done in order to ensure
that changes to the monitor configuration in code always make it to the monitor
configuration in the device cloud:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">monitor_callback</span><span class="p">(</span><span class="n">json_data</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>  <span class="c"># message received</span>

<span class="c"># Listen for DataPoint updates</span>
<span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;DataPoint[U]&#39;</span><span class="p">]</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">get_monitor</span><span class="p">(</span><span class="n">topics</span><span class="p">)</span>
<span class="k">if</span> <span class="n">monitor</span><span class="p">:</span>
    <span class="n">monitor</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">create_tcp_monitor</span><span class="p">(</span><span class="n">topics</span><span class="p">)</span>
<span class="n">monitor</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">monitor_callback</span><span class="p">)</span>

<span class="c"># later...</span>
<span class="n">dc</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">stop_listeners</span><span class="p">()</span>
</pre></div>
</div>
<p>When updates to any DataPoint in the device cloud occurs, the callback will be called
with a data structure like this one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;Document&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;Msg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;DataPoint&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;cstId&#39;</span><span class="p">:</span> <span class="mi">7603</span><span class="p">,</span>
                                    <span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="mf">0.411700824929</span><span class="p">,</span>
                                    <span class="s">&#39;description&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                                    <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="s">&#39;684572e0-12c4-11e5-8507-fa163ed4cf14&#39;</span><span class="p">,</span>
                                    <span class="s">&#39;quality&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                    <span class="s">&#39;serverTimestamp&#39;</span><span class="p">:</span> <span class="mi">1434307047694</span><span class="p">,</span>
                                    <span class="s">&#39;streamId&#39;</span><span class="p">:</span> <span class="s">&#39;test&#39;</span><span class="p">,</span>
                                    <span class="s">&#39;streamUnits&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                                    <span class="s">&#39;timestamp&#39;</span><span class="p">:</span> <span class="mi">1434307047694</span><span class="p">},</span>
                        <span class="s">&#39;group&#39;</span><span class="p">:</span> <span class="s">&#39;*&#39;</span><span class="p">,</span>
                        <span class="s">&#39;operation&#39;</span><span class="p">:</span> <span class="s">&#39;INSERTION&#39;</span><span class="p">,</span>
                        <span class="s">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s">&#39;2015-06-14T18:37:27.815Z&#39;</span><span class="p">,</span>
                        <span class="s">&#39;topic&#39;</span><span class="p">:</span> <span class="s">&#39;7603/DataPoint/test&#39;</span><span class="p">}}}</span>
</pre></div>
</div>
<dl class="method">
<dt id="devicecloud.monitor.MonitorAPI.create_tcp_monitor">
<code class="descname">create_tcp_monitor</code><span class="sig-paren">(</span><em>topics</em>, <em>batch_size=1</em>, <em>batch_duration=0</em>, <em>compression='gzip'</em>, <em>format_type='json'</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.MonitorAPI.create_tcp_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a TCP Monitor instance in the device cloud for a given list of topics</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>topics</strong> &#8211; a string list of topics (e.g. [&#8216;DeviceCore[U]&#8217;,
&#8216;FileDataCore&#8217;]).</li>
<li><strong>batch_size</strong> &#8211; How many Msgs received before sending data.</li>
<li><strong>batch_duration</strong> &#8211; How long to wait before sending batch if it
does not exceed batch_size.</li>
<li><strong>compression</strong> &#8211; Compression value (i.e. &#8216;gzip&#8217;).</li>
<li><strong>format_type</strong> &#8211; What format server should send data in (i.e. &#8216;xml&#8217; or &#8216;json&#8217;).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns an object of the created Monitor</p>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor.MonitorAPI.create_http_monitor">
<code class="descname">create_http_monitor</code><span class="sig-paren">(</span><em>topics</em>, <em>transport_url</em>, <em>transport_token=None</em>, <em>transport_method='PUT'</em>, <em>connect_timeout=0</em>, <em>response_timeout=0</em>, <em>batch_size=1</em>, <em>batch_duration=0</em>, <em>compression='none'</em>, <em>format_type='json'</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.MonitorAPI.create_http_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a HTTP Monitor instance in the device cloud for a given list of topics</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>topics</strong> &#8211; a string list of topics (e.g. [&#8216;DeviceCore[U]&#8217;,
&#8216;FileDataCore&#8217;]).</li>
<li><strong>transport_url</strong> &#8211; URL of the customer web server.</li>
<li><strong>transport_token</strong> &#8211; Credentials for basic authentication in the following format: username:password</li>
<li><strong>transport_method</strong> &#8211; HTTP method to use for sending data: PUT or POST. The default is PUT.</li>
<li><strong>connect_timeout</strong> &#8211; A value of 0 means use the system default of 5000 (5 seconds).</li>
<li><strong>response_timeout</strong> &#8211; A value of 0 means use the system default of 5000 (5 seconds).</li>
<li><strong>batch_size</strong> &#8211; How many Msgs received before sending data.</li>
<li><strong>batch_duration</strong> &#8211; How long to wait before sending batch if it
does not exceed batch_size.</li>
<li><strong>compression</strong> &#8211; Compression value (i.e. &#8216;gzip&#8217;).</li>
<li><strong>format_type</strong> &#8211; What format server should send data in (i.e. &#8216;xml&#8217; or &#8216;json&#8217;).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns an object of the created Monitor</p>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor.MonitorAPI.get_monitors">
<code class="descname">get_monitors</code><span class="sig-paren">(</span><em>condition=None</em>, <em>page_size=1000</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.MonitorAPI.get_monitors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over all monitors matching the provided condition</p>
<p>Get all inactive monitors and print id:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">mon</span> <span class="ow">in</span> <span class="n">dc</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">get_monitors</span><span class="p">(</span><span class="n">MON_STATUS_ATTR</span> <span class="o">==</span> <span class="s">&quot;DISABLED&quot;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">mon</span><span class="o">.</span><span class="n">get_id</span><span class="p">())</span>
</pre></div>
</div>
<p>Get all the HTTP monitors and print id:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">mon</span> <span class="ow">in</span> <span class="n">dc</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">get_monitors</span><span class="p">(</span><span class="n">MON_TRANSPORT_TYPE_ATTR</span> <span class="o">==</span> <span class="s">&quot;http&quot;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">mon</span><span class="o">.</span><span class="n">get_id</span><span class="p">())</span>
</pre></div>
</div>
<p>Many other possibilities exist.  See the <code class="xref py py-mod docutils literal"><span class="pre">devicecloud.condition</span></code> documention
for additional details on building compound expressions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>condition</strong> (<a class="reference internal" href="core.html#devicecloud.conditions.Expression" title="devicecloud.conditions.Expression"><code class="xref py py-class docutils literal"><span class="pre">Expression</span></code></a> or None) &#8211; An <a class="reference internal" href="core.html#devicecloud.conditions.Expression" title="devicecloud.conditions.Expression"><code class="xref py py-class docutils literal"><span class="pre">Expression</span></code></a> which defines the condition
which must be matched on the monitor that will be retrieved from
the device cloud. If a condition is unspecified, an iterator over
all monitors for this account will be returned.</li>
<li><strong>page_size</strong> (<a class="reference external" href="http://docs.python.org/3/library/functions.html#int" title="(in Python v3.5)"><em>int</em></a>) &#8211; The number of results to fetch in a single page.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Generator yielding <a class="reference internal" href="#devicecloud.monitor.DeviceCloudMonitor" title="devicecloud.monitor.DeviceCloudMonitor"><code class="xref py py-class docutils literal"><span class="pre">DeviceCloudMonitor</span></code></a> instances matching the
provided conditions.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor.MonitorAPI.get_monitor">
<code class="descname">get_monitor</code><span class="sig-paren">(</span><em>topics</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.MonitorAPI.get_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to find a Monitor in device cloud that matches the provided topics</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topics</strong> &#8211; a string list of topics (e.g. <code class="docutils literal"><span class="pre">['DeviceCore[U]',</span> <span class="pre">'FileDataCore'])</span></code>)</td>
</tr>
</tbody>
</table>
<p>Returns a <a class="reference internal" href="#devicecloud.monitor.DeviceCloudMonitor" title="devicecloud.monitor.DeviceCloudMonitor"><code class="xref py py-class docutils literal"><span class="pre">DeviceCloudMonitor</span></code></a> if found, otherwise None.</p>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor.MonitorAPI.stop_listeners">
<code class="descname">stop_listeners</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.MonitorAPI.stop_listeners" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop any listener threads that may be running and join on them</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="devicecloud.monitor.DeviceCloudMonitor">
<em class="property">class </em><code class="descclassname">devicecloud.monitor.</code><code class="descname">DeviceCloudMonitor</code><span class="sig-paren">(</span><em>conn</em>, <em>monitor_id</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.DeviceCloudMonitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides access to a single monitor instance on the device cloud</p>
<p>This is a base class that should not be instantiated directly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="method">
<dt id="devicecloud.monitor.DeviceCloudMonitor.get_id">
<code class="descname">get_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.DeviceCloudMonitor.get_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ID of this monitor as an integer</p>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor.DeviceCloudMonitor.get_metadata">
<code class="descname">get_metadata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.DeviceCloudMonitor.get_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Get additional information about this monitor</p>
<p>This method returns a dictionary where the keys contain information about the
monitor.  The returned data will look something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&#39;cstId&#39;</span><span class="p">:</span> <span class="s">&#39;7603&#39;</span><span class="p">,</span>
    <span class="s">&#39;monBatchDuration&#39;</span><span class="p">:</span> <span class="s">&#39;10&#39;</span><span class="p">,</span>
    <span class="s">&#39;monBatchSize&#39;</span><span class="p">:</span> <span class="s">&#39;1&#39;</span><span class="p">,</span>
    <span class="s">&#39;monCompression&#39;</span><span class="p">:</span> <span class="s">&#39;zlib&#39;</span><span class="p">,</span>
    <span class="s">&#39;monFormatType&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
    <span class="s">&#39;monId&#39;</span><span class="p">:</span> <span class="s">&#39;178023&#39;</span><span class="p">,</span>
    <span class="s">&#39;monStatus&#39;</span><span class="p">:</span> <span class="s">&#39;INACTIVE&#39;</span><span class="p">,</span>
    <span class="s">&#39;monTopic&#39;</span><span class="p">:</span> <span class="s">&#39;DeviceCore,FileDataCore,FileData,DataPoint&#39;</span><span class="p">,</span>
    <span class="s">&#39;monTransportType&#39;</span><span class="p">:</span> <span class="s">&#39;tcp&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor.DeviceCloudMonitor.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.DeviceCloudMonitor.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete this monitor form the device cloud</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="devicecloud.monitor.HTTPDeviceCloudMonitor">
<em class="property">class </em><code class="descclassname">devicecloud.monitor.</code><code class="descname">HTTPDeviceCloudMonitor</code><span class="sig-paren">(</span><em>conn</em>, <em>monitor_id</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.HTTPDeviceCloudMonitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Device Cloud Monitor with HTTP transport type</p>
</dd></dl>

<dl class="class">
<dt id="devicecloud.monitor.TCPDeviceCloudMonitor">
<em class="property">class </em><code class="descclassname">devicecloud.monitor.</code><code class="descname">TCPDeviceCloudMonitor</code><span class="sig-paren">(</span><em>conn</em>, <em>monitor_id</em>, <em>tcp_client_manager</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.TCPDeviceCloudMonitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Device Cloud Monitor with TCP transport type</p>
<dl class="method">
<dt id="devicecloud.monitor.TCPDeviceCloudMonitor.add_callback">
<code class="descname">add_callback</code><span class="sig-paren">(</span><em>callback</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor.TCPDeviceCloudMonitor.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a secure SSL/TCP listen session to the device cloud</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-devicecloud.monitor_tcp"></span><dl class="exception">
<dt id="devicecloud.monitor_tcp.PushException">
<em class="property">exception </em><code class="descclassname">devicecloud.monitor_tcp.</code><code class="descname">PushException</code><a class="headerlink" href="#devicecloud.monitor_tcp.PushException" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates an issue interacting with Push Functionality.</p>
</dd></dl>

<dl class="class">
<dt id="devicecloud.monitor_tcp.PushSession">
<em class="property">class </em><code class="descclassname">devicecloud.monitor_tcp.</code><code class="descname">PushSession</code><span class="sig-paren">(</span><em>callback</em>, <em>monitor_id</em>, <em>client</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.PushSession" title="Permalink to this definition">¶</a></dt>
<dd><p>A PushSession is responsible for establishing a socket connection
with iDigi to receive events generated by Devices connected to
iDigi.</p>
<dl class="method">
<dt id="devicecloud.monitor_tcp.PushSession.send_connection_request">
<code class="descname">send_connection_request</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.PushSession.send_connection_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a ConnectionRequest to the iDigi server using the credentials
established with the id of the monitor as defined in the monitor
member.</p>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor_tcp.PushSession.start">
<code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.PushSession.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a TCP connection to the device cloud and sends a ConnectionRequest message</p>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor_tcp.PushSession.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.PushSession.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop/Close this session</p>
<p>Close the socket associated with this session and puts Session
into a state such that it can be re-established later.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="devicecloud.monitor_tcp.SecurePushSession">
<em class="property">class </em><code class="descclassname">devicecloud.monitor_tcp.</code><code class="descname">SecurePushSession</code><span class="sig-paren">(</span><em>callback</em>, <em>monitor_id</em>, <em>client</em>, <em>ca_certs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.SecurePushSession" title="Permalink to this definition">¶</a></dt>
<dd><p>SecurePushSession extends PushSession by wrapping the socket connection
in SSL.  It expects the certificate to match any of those in the passed
in ca_certs member file.</p>
<dl class="method">
<dt id="devicecloud.monitor_tcp.SecurePushSession.start">
<code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.SecurePushSession.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a SSL connection to the iDigi Server and sends a
ConnectionRequest message.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="devicecloud.monitor_tcp.CallbackWorkerPool">
<em class="property">class </em><code class="descclassname">devicecloud.monitor_tcp.</code><code class="descname">CallbackWorkerPool</code><span class="sig-paren">(</span><em>write_queue=None</em>, <em>size=1</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.CallbackWorkerPool" title="Permalink to this definition">¶</a></dt>
<dd><p>A Worker Pool implementation that creates a number of predefined threads
used for invoking Session callbacks.</p>
<dl class="method">
<dt id="devicecloud.monitor_tcp.CallbackWorkerPool.queue_callback">
<code class="descname">queue_callback</code><span class="sig-paren">(</span><em>session</em>, <em>block_id</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.CallbackWorkerPool.queue_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Queues up a callback event to occur for a session with the given
payload data.  Will block if the queue is full.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>session</strong> &#8211; the session with a defined callback function to call.</li>
<li><strong>block_id</strong> &#8211; the block_id of the message received.</li>
<li><strong>data</strong> &#8211; the data payload of the message received.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="devicecloud.monitor_tcp.TCPClientManager">
<em class="property">class </em><code class="descclassname">devicecloud.monitor_tcp.</code><code class="descname">TCPClientManager</code><span class="sig-paren">(</span><em>conn</em>, <em>secure=True</em>, <em>ca_certs=None</em>, <em>workers=1</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.TCPClientManager" title="Permalink to this definition">¶</a></dt>
<dd><p>A Client for the &#8216;Push&#8217; feature in the device cloud</p>
<dl class="method">
<dt id="devicecloud.monitor_tcp.TCPClientManager.create_session">
<code class="descname">create_session</code><span class="sig-paren">(</span><em>callback</em>, <em>monitor_id</em><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.TCPClientManager.create_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and Returns a PushSession instance based on the input monitor
and callback.  When data is received, callback will be invoked.
If neither monitor or monitor_id are specified, throws an Exception.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>callback</strong> &#8211; Callback function to call when PublishMessage
messages are received. Expects 1 argument which will contain the
payload of the pushed message.  Additionally, expects
function to return True if callback was able to process
the message, False or None otherwise.</li>
<li><strong>monitor_id</strong> &#8211; The id of the Monitor, will be queried
to understand parameters of the monitor.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="devicecloud.monitor_tcp.TCPClientManager.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#devicecloud.monitor_tcp.TCPClientManager.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops all session activity.</p>
<p>Blocks until io and writer thread dies</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ws.html" class="btn btn-neutral float-right" title="Direct Web Services API" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="filesystem.html" class="btn btn-neutral" title="File System Service API" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Etherios, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>